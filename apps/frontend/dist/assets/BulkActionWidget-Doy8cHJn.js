import{b as E,r as t,s as T,j as e,c as v,a as L,B as A,l as M,I as N}from"./index-JBX9P6Qg.js";import{S as m}from"./Select-BM0zQtf0.js";const W=({onUpdate:S})=>{const{classes:l,actionPresets:n,addBulkAction:k}=E(),[r,P]=t.useState("points"),[c,u]=t.useState(""),[x,h]=t.useState(10),[i,p]=t.useState(""),[o,j]=t.useState(""),[f,g]=t.useState(!1),[y,a]=t.useState(null),[C,b]=t.useState(!1),I=t.useMemo(()=>Array.isArray(n)?n.filter(s=>s.type===T.MEDAL&&!s.isArchived):[],[n]),B=()=>{u(l.length>0?l[0].id:""),h(10),p(""),j("")},w=()=>{B(),a(null),b(!1)},q=async s=>{if(s.preventDefault(),a(null),!c){a("Please select a class.");return}let d;if(r==="points"){if(!i){a("Please provide a reason for the points.");return}d={type:"points",points:x,category:"Bulk Action",description:i}}else{if(!o){a("Please select a medal preset.");return}d={type:"badge",presetId:o}}g(!0);try{await k(c,d),S(),b(!0)}catch(D){a(D.message)}finally{g(!1)}};return C?e.jsx(v,{children:e.jsxs("div",{className:"text-center p-4 h-full flex flex-col justify-center items-center",children:[e.jsx(L,{className:"mx-auto h-12 w-12 text-secondary"}),e.jsx("h3",{className:"mt-2 text-lg font-medium text-text-primary",children:"Success!"}),e.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Bulk action completed successfully."}),e.jsx(A,{onClick:w,className:"mt-6",variant:"secondary",children:"Perform Another Action"})]})}):e.jsxs(v,{children:[e.jsxs("h3",{className:"text-xl font-semibold text-text-primary flex items-center gap-3 mb-4",children:[e.jsx(M,{className:"h-6 w-6"}),"Bulk Action Tool"]}),e.jsxs("form",{onSubmit:q,className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-end",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Select Action Type"}),e.jsxs(m,{value:r,onChange:s=>P(s.target.value),children:[e.jsx("option",{value:"points",children:"Award Points"}),e.jsx("option",{value:"badge",children:"Award Badge"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Target Class"}),e.jsxs(m,{value:c,onChange:s=>u(s.target.value),required:!0,children:[e.jsx("option",{value:"",disabled:!0,children:"-- Select a class --"}),Array.isArray(l)?l.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id)):[]]})]}),r==="points"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Points to Award"}),e.jsx(N,{type:"number",value:x,onChange:s=>h(Number(s.target.value)),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Reason"}),e.jsx(N,{type:"text",value:i,onChange:s=>p(s.target.value),placeholder:"e.g., School fair participation",required:!0})]})]}):e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Medal Preset"}),e.jsxs(m,{value:o,onChange:s=>j(s.target.value),required:!0,children:[e.jsx("option",{value:"",disabled:!0,children:"-- Select a badge --"}),I.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),y&&e.jsx("p",{className:"md:col-span-2 text-sm text-danger",children:y}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(A,{type:"submit",className:"w-full",disabled:f,children:f?"Processing...":"Apply Bulk Action"})})]})]})};export{W as BulkActionWidget};
