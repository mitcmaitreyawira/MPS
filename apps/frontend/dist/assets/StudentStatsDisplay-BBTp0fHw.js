import{P as a,t as o,q as h,j as e,M as g,V as f,N as j}from"./index-JBX9P6Qg.js";import{B as b}from"./BadgeIconRenderer-BjlOxHvs.js";const N=(c,x)=>{const i=x.filter(t=>t.studentId===c),l=Math.max(0,i.reduce((t,n)=>t+n.points,0)),s=i.filter(t=>t.badge),d=s.length,r=y(i),m={[a.REWARD]:i.filter(t=>t.type===a.REWARD).reduce((t,n)=>t+n.points,0),[a.VIOLATION]:i.filter(t=>t.type===a.VIOLATION).reduce((t,n)=>t+n.points,0),[a.QUEST]:i.filter(t=>t.type===a.QUEST).reduce((t,n)=>t+n.points,0),[a.APPEAL_REVERSAL]:i.filter(t=>t.type===a.APPEAL_REVERSAL).reduce((t,n)=>t+n.points,0),[a.OVERRIDE]:i.filter(t=>t.type===a.OVERRIDE).reduce((t,n)=>t+n.points,0)},p={[o.GOLD]:s.filter(t=>{var n;return((n=t.badge)==null?void 0:n.tier)===o.GOLD}).length,[o.SILVER]:s.filter(t=>{var n;return((n=t.badge)==null?void 0:n.tier)===o.SILVER}).length,[o.BRONZE]:s.filter(t=>{var n;return((n=t.badge)==null?void 0:n.tier)===o.BRONZE}).length},u=i.sort((t,n)=>new Date(n.timestamp).getTime()-new Date(t.timestamp).getTime()).slice(0,5);return{totalPoints:l,badgeCount:d,streak:r,pointsByType:m,badgesByTier:p,recentActivity:u}},y=c=>{if(c.length===0)return 0;const x=c.sort((l,s)=>new Date(s.timestamp).getTime()-new Date(l.timestamp).getTime()),i=x.find(l=>l.type===a.VIOLATION);if(i){const l=new Date(i.timestamp),s=new Date;s.setHours(23,59,59,999),l.setHours(0,0,0,0);const d=s.getTime()-l.getTime(),r=Math.floor(d/(1e3*60*60*24));return Math.max(0,r)}else{const l=x.filter(s=>s.points>0).sort((s,d)=>new Date(s.timestamp).getTime()-new Date(d.timestamp).getTime())[0];if(l){const s=new Date(l.timestamp),d=new Date;d.setHours(23,59,59,999),s.setHours(0,0,0,0);const r=d.getTime()-s.getTime(),m=Math.floor(r/(1e3*60*60*24));return Math.max(0,m)}return 0}},w=({user:c,points:x,awards:i=[]})=>{if(c.role!==h.STUDENT)return null;const l=x||[],s=N(c.id,l),d=i.length>0?i.length:s.badgeCount;return i.length>0?(i.filter(r=>r.tier===o.GOLD).length,i.filter(r=>r.tier===o.SILVER).length,i.filter(r=>r.tier===o.BRONZE).length):s.badgesByTier,e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-200 p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(g,{className:"h-5 w-5 text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-blue-800",children:"Detailed Statistics"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-green-50 rounded-xl p-4 border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Total Points"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.totalPoints})]}),e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(f,{className:"h-5 w-5 text-green-600"})})]}),e.jsxs("div",{className:"mt-2 text-xs text-green-500",children:[e.jsxs("span",{className:"text-green-600",children:["+",s.pointsByType.reward]})," rewards,",e.jsx("span",{className:"text-red-600",children:s.pointsByType.violation})," violations"]})]}),e.jsxs("div",{className:"bg-purple-50 rounded-xl p-4 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-600 font-medium",children:"Total Awards"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:d})]}),e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx(g,{className:"h-5 w-5 text-purple-600"})})]}),e.jsx("div",{className:"mt-2 text-xs text-purple-600 font-medium",children:"Get a awards to collect more and show off to your friends #hollyairball"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-xl p-4 border border-orange-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-orange-600 font-medium",children:"Current Streak"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:s.streak})]}),e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx(j,{className:"h-6 w-6 text-orange-600"})})]}),e.jsx("div",{className:"mt-2 text-xs text-orange-500",children:"This will get reset when u got violation"})]})]}),s.recentActivity.length>0&&e.jsxs("div",{className:"mt-4 pt-3 border-t border-blue-200",children:[e.jsx("p",{className:"text-xs font-medium text-blue-600 mb-2",children:"Recent Activity"}),e.jsx("div",{className:"space-y-1",children:s.recentActivity.slice(0,3).map((r,m)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${r.points>0?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300 truncate max-w-32",children:r.description})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsxs("span",{className:`font-medium ${r.points>0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[r.points>0?"+":"",r.points]}),r.badge&&e.jsx(b,{badge:r.badge,className:"h-3 w-3"})]})]},r.id))})]})]})};export{w as S,N as c};
