import{j as e,D as se,C as be,U as ge,Q as z,B as j,r as c,a as A,u as te,b as ae,c as fe,A as L,R as H,g as je,d as Ne,e as ve,f as we,h as R,M as ye,E as X,S as Ce}from"./index-JBX9P6Qg.js";import{C as Se,H as ke,A as Ae,R as Ie}from"./ReportTeacherFooter-CkW1LVSP.js";import{B as Pe}from"./BadgeIconRenderer-BjlOxHvs.js";import{g as O,a as E}from"./helpers-snl2sRJ-.js";import{M as De}from"./Modal-NYefmAjZ.js";import{C as W}from"./ConfirmationModal-CPL5EhPs.js";import{c as Re,S as Ee}from"./StudentStatsDisplay-BBTp0fHw.js";import"./SearchableSingleUserSelector-DWlEu3dp.js";import"./useDebounce-CwzWEB2R.js";const Z=({quest:s,participantInfo:l,studentTotalPoints:m,allParticipants:p=[],onAccept:o,onSubmit:t})=>{const g=s.expiresAt?new Date(s.expiresAt)<new Date:!1,u=p.filter(b=>b.questId===s.id).length,i=s.slotsAvailable?s.slotsAvailable-u:1/0,h=i<=0,x=()=>{if(l)switch(l.status){case z.IN_PROGRESS:return e.jsx(j,{size:"sm",onClick:()=>t==null?void 0:t(s.id),className:"bg-green-600 hover:bg-green-700 focus:ring-green-500 text-white w-full sm:w-auto",children:"Submit for Review"});case z.SUBMITTED_FOR_REVIEW:return e.jsx("div",{className:"text-sm font-semibold bg-slate-600 dark:bg-slate-500 text-white px-3 py-1.5 rounded-full text-center",children:"Pending Approval"});case z.COMPLETED:return e.jsx("div",{className:"text-sm font-semibold bg-secondary/80 text-white px-3 py-1.5 rounded-full text-center",children:"Completed!"});default:return null}else{const f=m!==void 0&&m<=s.requiredPoints&&!g&&!h;return e.jsx(j,{size:"sm",onClick:()=>o==null?void 0:o(s),disabled:!f,className:"bg-amber-600 hover:bg-amber-700 focus:ring-amber-500 text-white disabled:bg-slate-400 disabled:cursor-not-allowed w-full sm:w-auto",children:g?"Expired":h?"Full":"Accept Quest"})}},N=()=>l?null:m!==void 0&&m<=s.requiredPoints?e.jsx("p",{className:"text-xs text-secondary",children:"You meet the point requirement!"}):e.jsxs("p",{className:"text-xs text-danger",children:["Requires max. ",s.requiredPoints," pts (You have ",m,")"]}),r=s.badgeTier?{tier:s.badgeTier,icon:s.badgeIcon}:null;return e.jsxs("div",{className:"bg-amber-50/50 border-2 border-dashed border-amber-300 rounded-lg p-3 sm:p-5 flex flex-col h-full relative overflow-hidden transition-all duration-300 ease-out hover:scale-110 hover:border-solid hover:shadow-2xl hover:-translate-y-1 hover:border-amber-400",children:[e.jsxs("div",{className:"flex items-start space-x-3 sm:space-x-4 mb-3",children:[e.jsx("div",{className:"bg-amber-200 p-1.5 sm:p-2 rounded-full flex-shrink-0",children:e.jsx(se,{className:"h-5 w-5 sm:h-6 sm:w-6 text-amber-700"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"font-bold text-amber-900 text-base sm:text-lg",children:s.title}),e.jsx("p",{className:"text-xs sm:text-sm text-amber-800/80 mt-1",children:s.description})]})]}),e.jsxs("div",{className:"text-xs text-amber-800/90 space-y-1 my-2",children:[s.expiresAt&&e.jsxs("div",{className:`flex items-center gap-1.5 ${g?"text-danger":""}`,children:[e.jsx(be,{className:"h-4 w-4"}),e.jsxs("span",{children:["Expires ",new Date(s.expiresAt).toLocaleDateString()]})]}),s.slotsAvailable&&e.jsxs("div",{className:`flex items-center gap-1.5 ${h?"text-danger":""}`,children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsx("span",{children:isFinite(i)?`${i} slots left`:"Unlimited slots"})]})]}),(l==null?void 0:l.reviewNotes)&&e.jsxs("div",{className:"my-2 p-2 bg-red-100 border-l-4 border-danger rounded-r-md",children:[e.jsx("p",{className:"text-sm font-semibold text-red-800",children:"Feedback from your teacher:"}),e.jsxs("p",{className:"text-xs text-red-700 italic",children:['"',l.reviewNotes,'"']})]}),e.jsxs("div",{className:"mt-auto pt-4 flex flex-col items-start gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"font-bold text-lg text-accent",children:["+",s.points," Points"]}),r&&e.jsxs("div",{className:"flex items-center gap-1 text-xs font-semibold bg-yellow-200 text-yellow-800 px-2 py-0.5 rounded-full",children:[e.jsx(Pe,{badge:r,className:"h-4 w-4"}),e.jsx("span",{children:"+Badge"})]})]}),N()]}),x()]})]})},K=({data:s,valueKey:l,unit:m,currentUser:p})=>{const o=r=>!r.firstName&&!r.lastName?"Unknown User":`${r.firstName||""} ${r.lastName||""}`.trim(),t=(r,b)=>b==="totalPoints"?Math.round(r):r,g=(r,b)=>{if(b)return"text-blue-600";switch(r){case"totalPoints":return"text-green-600";case"streak":return"text-orange-600";case"awardPoints":return"text-purple-600";case"badgeCount":return"text-indigo-600";default:return"text-accent"}},u=s.findIndex(r=>r.student.id===(p==null?void 0:p.id)),i=u+1,h=u<30&&u>=0,x=u>=0?s[u]:null,N=r=>r===1?e.jsx("span",{className:"text-yellow-500 text-lg",children:"ðŸ¥‡"}):r===2?e.jsx("span",{className:"text-gray-400 text-lg",children:"ðŸ¥ˆ"}):r===3?e.jsx("span",{className:"text-amber-600 text-lg",children:"ðŸ¥‰"}):null;return e.jsxs("div",{className:"space-y-4",children:[!h&&x&&e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-3",children:"Your Performance:"}),e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-100 border-2 border-blue-200 rounded-xl p-3 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-10 h-10 aspect-square rounded-full flex items-center justify-center text-xs font-bold ring-2 ring-blue-300 flex-shrink-0 ${E(x.student.name)}`,children:O(x.student.name)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-base font-bold text-blue-800 truncate",children:x.student.name}),e.jsxs("div",{className:"text-xs text-blue-600",children:["Rank #",i]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:t(x[l],l)}),e.jsx("div",{className:"text-xs text-blue-500",children:m}),s.length>0&&x[l]<s[0][l]&&e.jsxs("div",{className:"text-xs text-orange-500 mt-1",children:[t(s[0][l]-x[l],l)," behind #1"]})]})]})})]}),h&&x&&e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-3",children:"Your Performance:"}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-100 border-2 border-green-200 rounded-xl p-3 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-10 h-10 aspect-square rounded-full flex items-center justify-center text-xs font-bold ring-2 ring-green-300 flex-shrink-0 ${E(o(x.student))}`,children:O(o(x.student))}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-base font-bold text-green-800 truncate",children:o(x.student)}),e.jsxs("div",{className:"text-xs text-green-600",children:["Rank #",i," â€¢ TOP ",i<=3?"3":i<=10?"10":"30"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:t(x[l],l)}),e.jsx("div",{className:"text-xs text-green-500",children:m})]})]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-2",children:"Top 30 Rankings:"}),e.jsx("ul",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:s.slice(0,30).map((r,b)=>{const f=r.student.id===(p==null?void 0:p.id),n=b+1;return e.jsxs("li",{className:`flex items-center justify-between p-3 rounded-lg transition-all duration-200 ${f?"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 shadow-sm":"bg-slate-50 hover:bg-slate-100 border border-transparent"}`,children:[e.jsxs("div",{className:"flex items-center min-w-0 flex-1 gap-2",children:[e.jsxs("span",{className:`font-bold text-base w-8 flex-shrink-0 text-center ${f?"text-blue-600":"text-text-secondary"}`,children:["#",n]}),N(n),e.jsx("div",{className:`w-8 h-8 aspect-square rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 ${f?`ring-2 ring-blue-300 ${E(o(r.student))}`:E(o(r.student))}`,children:O(o(r.student))}),e.jsx("span",{className:`text-sm font-medium min-w-0 flex-1 ${f?"text-blue-800 font-semibold":"text-text-primary"}`,children:e.jsxs("span",{className:"block truncate",children:[o(r.student),f?" (You)":""]})})]}),e.jsxs("div",{className:`flex items-center font-bold ${g(l,f)}`,children:[t(r[l],l)," ",e.jsx("span",{className:`text-sm font-normal ml-1 ${f?"text-blue-500":"text-text-secondary"}`,children:m})]})]},r.student.id)})})]})]})},Le=({isOpen:s,onClose:l,pointLogId:m,onSubmitAppeal:p})=>{const[o,t]=c.useState(""),[g,u]=c.useState(!1),[i,h]=c.useState(null),x=()=>{t(""),h(null),u(!1),l()},N=async r=>{if(r.preventDefault(),!o.trim()){h({type:"error",message:"Please provide a reason for your appeal."});return}u(!0),h(null);try{await p({pointLogId:m,reason:o}),h({type:"success",message:"Your appeal has been submitted successfully."})}catch(b){h({type:"error",message:b.message}),u(!1)}};return e.jsx(De,{isOpen:s,onClose:x,title:(i==null?void 0:i.type)==="success"?"Success":"Submit an Appeal",children:(i==null?void 0:i.type)==="success"?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(A,{className:"mx-auto h-12 w-12 text-secondary"}),e.jsx("h3",{className:"mt-2 text-lg font-medium text-text-primary",children:"Appeal Submitted"}),e.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:i.message}),e.jsx(j,{onClick:x,className:"mt-6",variant:"secondary",children:"Close"})]}):e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-text-secondary mb-1",children:"Reason for Appeal"}),e.jsx("textarea",{id:"reason",value:o,onChange:r=>t(r.target.value),required:!0,rows:5,className:"shadow-sm appearance-none border border-border rounded-lg w-full py-2 px-3 bg-surface text-text-primary placeholder-text-secondary/70 leading-tight focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Please clearly and respectfully explain why you believe the point deduction was incorrect or should be reconsidered."}),e.jsx("p",{className:"text-xs text-text-secondary mt-2",children:"Your appeal will be sent to an administrator for review. Please be patient."})]}),(i==null?void 0:i.type)==="error"&&e.jsx("div",{className:"text-sm p-3 rounded-lg bg-red-100 text-red-800",children:i.message}),e.jsxs("div",{className:"pt-4 flex justify-end space-x-2",children:[e.jsx(j,{type:"button",variant:"neutral",onClick:x,children:"Cancel"}),e.jsx(j,{type:"submit",disabled:g,children:g?"Submitting...":"Submit Appeal"})]})]})})},ee=({status:s})=>{const l={[L.PENDING]:"bg-amber-100 text-amber-800",[L.APPROVED]:"bg-green-100 text-green-800",[L.REJECTED]:"bg-red-100 text-red-800",[H.NEW]:"bg-amber-100 text-amber-800",[H.REVIEWED]:"bg-green-100 text-green-800"};return e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full capitalize ${l[s]}`,children:s})},Te=({appeals:s,teacherReports:l,points:m,onUpdate:p})=>{const{user:o}=te(),{users:t,withdrawAppeal:g}=ae(),[u,i]=c.useState("appeals"),[h,x]=c.useState(null),N=c.useMemo(()=>o?s.filter(n=>n.studentId===o.id).map(n=>({...n,pointLog:m.find(v=>v.id===n.pointLogId)})):[],[s,o,m]),r=c.useMemo(()=>o?l.filter(n=>n.submittedByUserId===o.id).map(n=>({...n,teacher:t.find(v=>v.id===n.targetTeacherId)})):[],[l,o,t]),b=n=>{x(n)},f=async()=>{h&&(await g(h),p(),x(null))};return e.jsxs(e.Fragment,{children:[e.jsxs(fe,{title:"My Submissions",icon:e.jsx(se,{className:"h-5 w-5"}),children:[e.jsxs("div",{className:"flex space-x-1 rounded-lg bg-slate-100 p-1 mb-4",children:[e.jsxs(j,{size:"md",className:"w-full",onClick:()=>i("appeals"),variant:u==="appeals"?"primary":"neutral",children:["My Appeals (",N.length,")"]}),e.jsxs(j,{size:"md",className:"w-full",onClick:()=>i("reports"),variant:u==="reports"?"primary":"neutral",children:["My Reports (",r.length,")"]})]}),e.jsxs("div",{className:"max-h-80 overflow-y-auto pr-2 space-y-3",children:[u==="appeals"&&e.jsx(e.Fragment,{children:N.length===0?e.jsx("p",{className:"text-center text-text-secondary py-12",children:"You have not submitted any appeals."}):N.map(n=>{var v,C;return e.jsxs("div",{className:"p-3 bg-slate-50 border border-border rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-text-primary",children:["Appeal for: ",e.jsxs("span",{className:"text-danger",children:[(v=n.pointLog)==null?void 0:v.points," pts"]})," (",(C=n.pointLog)==null?void 0:C.category,")"]}),e.jsxs("p",{className:"text-xs text-text-secondary",children:["Submitted: ",new Date(n.submittedAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ee,{status:n.status}),n.status===L.PENDING&&e.jsx(j,{size:"sm",variant:"danger",className:"bg-danger/10 text-danger hover:bg-danger/20",onClick:()=>b(n.id),children:"Withdraw"})]})]},n.id)})}),u==="reports"&&e.jsx(e.Fragment,{children:r.length===0?e.jsx("p",{className:"text-center text-text-secondary py-12",children:"You have not submitted any reports."}):r.map(n=>{var v;return e.jsxs("div",{className:"p-3 bg-slate-50 border border-border rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-text-primary",children:["Report against: ",((v=n.teacher)==null?void 0:v.name)||"Unknown Teacher"]}),e.jsxs("p",{className:"text-xs text-text-secondary",children:["Submitted: ",new Date(n.timestamp).toLocaleDateString()," ",n.isAnonymous&&"(Anonymously)"]})]}),e.jsx(ee,{status:n.status})]},n.id)})})]})]}),e.jsx(W,{isOpen:!!h,onClose:()=>x(null),onConfirm:f,title:"Confirm Withdrawal",message:"Are you sure you want to withdraw this appeal? This action cannot be undone.",confirmText:"Confirm Withdraw",confirmVariant:"danger"})]})},V=({children:s,className:l="",title:m,icon:p,headerActions:o,variant:t="default",id:g})=>{const u=()=>{const i="rounded-2xl shadow-lg border";switch(t){case"gradient":return`${i} bg-gradient-to-br from-white to-blue-50 border-blue-200`;case"compact":return`${i} bg-white border-purple-200`;default:return`${i} bg-white border-indigo-200`}};return e.jsxs("div",{id:g,className:`${u()} transition-all duration-300 ease-out hover:shadow-xl hover:-translate-y-1 ${l}`,children:[m&&e.jsxs("div",{className:"px-6 py-4 border-b border-indigo-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[p&&e.jsx("div",{className:"text-indigo-600",children:p}),e.jsx("h3",{className:"text-xl font-semibold text-indigo-800",children:m})]}),o&&e.jsx("div",{className:"flex items-center space-x-2",children:o})]}),e.jsx("div",{className:"p-6",children:s})]})},We=()=>{var _;const{user:s,refreshUser:l}=te(),{joinQuest:m,submitQuestForReview:p,submitAppeal:o}=ae(),[t,g]=c.useState(null),[u,i]=c.useState(!0),[h,x]=c.useState(null),[N,r]=c.useState([]),[b,f]=c.useState("available"),[n,v]=c.useState("streak"),[C,Y]=c.useState("school"),[re,q]=c.useState(!1),[ne,le]=c.useState(null),[T,M]=c.useState(null),[S,Q]=c.useState(null),k=c.useCallback(async()=>{if(!(s!=null&&s.id)){console.log("StudentDashboard: User not available yet, skipping data fetch");return}i(!0),x(null);try{const a=await je();g(a);try{const d=await Ne(s.id);r(d.awards)}catch(d){d.status===403?(console.warn("StudentDashboard: Insufficient role permissions for awards - continuing without awards"),r([])):(console.error("Failed to fetch awards:",d),r([]))}}catch(a){a.status===403?(console.warn("StudentDashboard: Insufficient role permissions for dashboard data"),x("You do not have permission to access this dashboard. Please contact your administrator.")):(x("Failed to load dashboard data. Please try again later."),console.error(a))}finally{i(!1)}},[s==null?void 0:s.id]);c.useEffect(()=>{k()},[k]);const ie=async()=>{S&&(await m(S.id),await k(),Q(null))},oe=async()=>{T&&(await p(T),await k(),M(null))},de=async a=>{await o(a),await k()},I=c.useMemo(()=>(t==null?void 0:t.points)||[],[t]),w=c.useMemo(()=>s?Re(s.id,I):null,[s,I]),P=c.useMemo(()=>Math.max(0,Math.min(100,(w==null?void 0:w.totalPoints)||0)),[w]),D=P,{pointsGained:ce,pointsLost:xe,accountStatus:me,statusColor:ue,statusIcon:he}=c.useMemo(()=>{if(!w)return{pointsGained:0,pointsLost:0,accountStatus:"Safe",statusColor:"text-secondary",statusIcon:e.jsx(A,{className:"w-5 h-5"})};const a=w.pointsByType.reward+w.pointsByType.quest+w.pointsByType.appeal_reversal+w.pointsByType.override,d=Math.abs(w.pointsByType.violation);let y="Safe",U="text-secondary",F=e.jsx(A,{className:"w-5 h-5"});return D<70?(y="At Risk",U="text-danger",F=e.jsx(Ce,{className:"w-5 h-5"})):D<80&&(y="Warning",U="text-warning",F=e.jsx(X,{className:"w-5 h-5"})),{pointsGained:a,pointsLost:d,accountStatus:y,statusColor:U,statusIcon:F}},[w,D]),J=c.useMemo(()=>N.sort((a,d)=>{const y={gold:0,silver:1,bronze:2};return y[a.tier]-y[d.tier]}),[N]),pe=c.useMemo(()=>{if(!(t!=null&&t.leaderboardUsers)||!(s!=null&&s.id))return 0;const a=t.leaderboardUsers.find(d=>d.id===s.id);return(a==null?void 0:a.streak)||0},[t==null?void 0:t.leaderboardUsers,s==null?void 0:s.id]),{availableQuests:B,ongoingQuests:$}=c.useMemo(()=>{if(!t)return{availableQuests:[],ongoingQuests:[]};const a=new Set(t.questParticipants.map(d=>d.questId));return{availableQuests:t.quests.filter(d=>d.isActive&&!a.has(d.id)),ongoingQuests:t.questParticipants.filter(d=>d.status==="in_progress"||d.status==="submitted_for_review"||d.status==="completed")}},[t]);if(u)return e.jsx(ve,{});if(h||!t)return e.jsx("div",{className:"text-center text-danger",children:h||"Could not load data."});if(!s)return null;const G=t.leaderboardUsers||[];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-6 space-y-6",children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-200 p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-full flex items-center justify-center text-white font-semibold text-sm aspect-square flex-shrink-0",children:s.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl lg:text-3xl font-bold text-blue-900",children:["Welcome back, ",s.firstName&&s.lastName?`${s.firstName} ${s.lastName}`:s.name]}),e.jsxs("p",{className:"text-blue-700",children:[s.nisn," - ",s.role]})]})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm bg-blue-100 px-4 py-2 rounded-lg",children:[e.jsx(we,{className:"h-5 w-5 text-blue-600"}),e.jsxs("span",{className:"text-blue-700",children:["Class: ",e.jsx("strong",{className:"text-blue-900",children:((_=t==null?void 0:t.userClass)==null?void 0:_.name)||"N/A"})]})]}),e.jsx("div",{className:"flex items-center space-x-2 text-sm bg-gradient-to-r from-green-100 to-emerald-100 px-4 py-2 rounded-lg",children:e.jsxs("span",{className:"text-green-700",children:["Points: ",e.jsxs("strong",{className:"text-green-800",children:[P,"/100"]})]})})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"xl:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-indigo-200 p-6",children:[e.jsxs("div",{className:"relative w-max mx-auto mb-6",children:[e.jsx(Se,{goal:100,points:D,size:200,strokeWidth:16}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-center",children:[e.jsx("span",{className:"text-4xl lg:text-5xl font-bold text-indigo-900",children:P}),e.jsx("span",{className:"text-sm text-indigo-600 mb-2",children:"/ 100 Points"}),e.jsxs("div",{className:`flex items-center space-x-2 ${ue}`,children:[he,e.jsx("span",{className:"font-semibold text-sm",children:me})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"bg-green-50 rounded-xl p-3",children:[e.jsxs("p",{className:"text-xl font-bold text-green-600",children:["+",ce]}),e.jsx("p",{className:"text-xs text-green-700",children:"Earned"})]}),e.jsxs("div",{className:"bg-red-50 rounded-xl p-3",children:[e.jsxs("p",{className:"text-xl font-bold text-red-600",children:["-",xe]}),e.jsx("p",{className:"text-xs text-red-700",children:"Lost"})]}),e.jsxs("div",{className:"bg-amber-50 rounded-xl p-2",children:[e.jsx("p",{className:"text-xl font-bold text-amber-600",children:pe}),e.jsx("p",{className:"text-xs text-amber-700",children:"Streak"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Quick Access"}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide pb-1",children:[e.jsxs("button",{onClick:()=>{var a;return(a=document.getElementById("leaderboard-section"))==null?void 0:a.scrollIntoView({behavior:"smooth"})},className:"flex-shrink-0 flex items-center gap-2 bg-blue-50 hover:bg-blue-100 text-blue-700 px-3 py-2 rounded-lg text-xs font-medium transition-colors duration-200",children:[e.jsx(R,{className:"w-4 h-4"}),"Leaderboard"]}),e.jsxs("button",{onClick:()=>{var a;return(a=document.getElementById("quests-section"))==null?void 0:a.scrollIntoView({behavior:"smooth"})},className:"flex-shrink-0 flex items-center gap-2 bg-indigo-50 hover:bg-indigo-100 text-indigo-700 px-3 py-2 rounded-lg text-xs font-medium transition-colors duration-200",children:[e.jsx(A,{className:"w-4 h-4"}),"Quests"]}),e.jsxs("button",{onClick:()=>{var a;return(a=document.getElementById("awards-section"))==null?void 0:a.scrollIntoView({behavior:"smooth"})},className:"flex-shrink-0 flex items-center gap-2 bg-pink-50 hover:bg-pink-100 text-pink-700 px-3 py-2 rounded-lg text-xs font-medium transition-colors duration-200",children:[e.jsx(ye,{className:"w-4 h-4"}),"Awards"]}),e.jsxs("button",{onClick:()=>{var a;return(a=document.getElementById("activity-section"))==null?void 0:a.scrollIntoView({behavior:"smooth"})},className:"flex-shrink-0 flex items-center gap-2 bg-green-50 hover:bg-green-100 text-green-700 px-3 py-2 rounded-lg text-xs font-medium transition-colors duration-200",children:[e.jsx(R,{className:"w-4 h-4"}),"Activity"]}),e.jsxs("button",{onClick:()=>{var a;return(a=document.getElementById("submissions-section"))==null?void 0:a.scrollIntoView({behavior:"smooth"})},className:"flex-shrink-0 flex items-center gap-2 bg-purple-50 hover:bg-purple-100 text-purple-700 px-3 py-2 rounded-lg text-xs font-medium transition-colors duration-200",children:[e.jsx(X,{className:"w-4 h-4"}),"Submissions"]})]})]}),s&&e.jsx(Ee,{user:s,points:I,awards:N}),e.jsx("div",{id:"submissions-section",className:"bg-white rounded-2xl shadow-lg border border-purple-200",children:e.jsx(Te,{appeals:t.appeals,teacherReports:t.teacherReports,points:t.points,onUpdate:k})})]}),e.jsxs("div",{className:"xl:col-span-3 space-y-6",children:[e.jsxs(V,{title:"Leaderboard",icon:e.jsx(R,{className:"w-6 h-6"}),variant:"default",id:"leaderboard-section",children:[t.classLeaderboardUsers&&t.classLeaderboardUsers.length>0&&e.jsxs("div",{className:"flex space-x-1 rounded-xl bg-green-100 p-1 mb-4",children:[e.jsx(j,{size:"sm",className:"flex-1",onClick:()=>Y("school"),variant:C==="school"?"primary":"neutral",children:"School"}),e.jsx(j,{size:"sm",className:"flex-1",onClick:()=>Y("class"),variant:C==="class"?"primary":"neutral",children:"Class"})]}),e.jsxs("div",{className:"flex space-x-1 rounded-xl bg-blue-100 p-1 mb-6 overflow-x-auto",children:[e.jsx(j,{size:"sm",className:"flex-1 whitespace-nowrap",onClick:()=>v("streak"),variant:n==="streak"?"primary":"neutral",children:"Top Streak"}),e.jsx(j,{size:"sm",className:"flex-1 whitespace-nowrap",onClick:()=>v("awards"),variant:n==="awards"?"primary":"neutral",children:"Top Awards"})]}),n==="streak"?e.jsx(K,{data:[...C==="class"&&t.classLeaderboardUsers?t.classLeaderboardUsers:G].sort((a,d)=>(d.streak||0)-(a.streak||0)).map(a=>({student:a,streak:a.streak||0})),valueKey:"streak",unit:"days",currentUser:s}):e.jsx(K,{data:[...C==="class"&&t.classLeaderboardUsers?t.classLeaderboardUsers:G].sort((a,d)=>(d.awardPoints||0)-(a.awardPoints||0)).map(a=>({student:a,awardPoints:a.awardPoints||0})),valueKey:"awardPoints",unit:"pts",currentUser:s})]}),e.jsxs(V,{title:"Quests",icon:e.jsx(A,{className:"w-6 h-6"}),variant:"default",id:"quests-section",children:[e.jsxs("div",{className:"flex space-x-1 rounded-xl bg-indigo-100 p-1 mb-6",children:[e.jsxs(j,{size:"md",className:"w-full",onClick:()=>f("available"),variant:b==="available"?"primary":"neutral",children:["Available Quests (",B.length,")"]}),e.jsxs(j,{size:"md",className:"w-full",onClick:()=>f("ongoing"),variant:b==="ongoing"?"primary":"neutral",children:["My Quests (",$.length,")"]})]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:b==="available"?B.length>0?B.map(a=>e.jsx(Z,{quest:a,onAccept:()=>Q(a),studentTotalPoints:P,allParticipants:t.questParticipants},a.id)):e.jsx("p",{className:"text-center text-indigo-500 py-8",children:"No new quests are available."}):$.length>0?$.map(a=>{const d=t.quests.find(y=>y.id===a.questId);return d?e.jsx(Z,{quest:d,participantInfo:a,onSubmit:()=>M(d.id)},a.questId):null}):e.jsx("p",{className:"text-center text-indigo-500 py-8",children:"You haven't joined any quests."})})]})]})]}),e.jsx("div",{id:"awards-section",className:"bg-white rounded-2xl shadow-lg border border-pink-200 transition-all duration-300 ease-out hover:shadow-xl hover:-translate-y-1",children:e.jsx("div",{className:"p-6 min-h-fit",children:J.length>0?e.jsx("div",{className:"w-full overflow-visible",children:e.jsx(ke,{awards:J})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-pink-500 mb-2",children:"No awards earned yet. Complete quests and excel in your studies to earn your first award!"}),e.jsx("p",{className:"text-pink-400 text-sm",children:"Get a awards to collect more and show off to your friends #hollyairball"})]})})}),e.jsx(V,{title:"Recent Activity",icon:e.jsx(R,{className:"w-6 h-6"}),variant:"default",id:"activity-section",children:e.jsx(Ae,{points:I,users:t.leaderboardUsers,appeals:t.appeals,onAppealRequest:a=>{le(a),q(!0)}})}),e.jsx("div",{className:"mt-8",children:e.jsx(Ie,{})})]})}),e.jsx(Le,{isOpen:re,onClose:()=>q(!1),pointLogId:ne||"",onSubmitAppeal:de}),e.jsx(W,{isOpen:!!S,onClose:()=>Q(null),onConfirm:ie,title:"Confirm Join Quest",message:e.jsxs("p",{children:['Are you sure you want to join the quest "',e.jsx("strong",{children:S==null?void 0:S.title}),'"?']}),confirmText:"Join Quest",confirmVariant:"secondary"}),e.jsx(W,{isOpen:!!T,onClose:()=>M(null),onConfirm:oe,title:"Confirm Quest Submission",message:"Are you sure you want to submit this quest for review? You cannot make changes after submitting.",confirmText:"Submit for Review",confirmVariant:"secondary"})]})};export{We as default};
